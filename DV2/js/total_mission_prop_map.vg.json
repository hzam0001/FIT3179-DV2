{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 900,
  "height": 500,
  "title": {
    "text": "Total Missile Launches by Country (1957-1991)",
    "fontSize": 18,
    "font": "Arial",
    "anchor": "middle"
  },
  "projection": { "type": "equalEarth" },
  "layer": [
    {
      "data": {
        "url": "https://raw.githubusercontent.com/hzam0001/FIT3179-DV2/main/Week9_HW/data/world_map.topojson",
        "format": { "type": "topojson", "feature": "ne_110m_admin_0_countries" }
      },
      "mark": { "type": "geoshape", "fill": "lightgray", "stroke": "white", "strokeWidth": 0.5 }
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/hzam0001/FIT3179-DV2/main/Week9_HW/data/world_map.topojson",
        "format": { "type": "topojson", "feature": "ne_110m_graticules_30" }
      },
      "mark": { "type": "geoshape", "fill": null, "stroke": "lightgray", "strokeWidth": 0.6 }
    },
    {
      "data": {
        "url": "https://raw.githubusercontent.com/hzam0001/FIT3179-DV2/main/Week9_HW/data/total_missions.csv"
      },
      "transform": [
        { "filter": "datum.Year >= 1957 && datum.Year <= 1991" },
        { "calculate": "toNumber(datum.Latitude)", "as": "lat_num" },
        { "calculate": "toNumber(datum.Longitude)", "as": "lon_num" },
        {
          "aggregate": [{ "op": "count", "as": "mission_count" }],
          "groupby": ["Country", "lat_num", "lon_num"]
        }
      ],
      "mark": {
        "type": "circle",
        "opacity": 0.7,
        "stroke": "white",
        "strokeWidth": 1,
        "color": "red"
      },
      "encoding": {
        "longitude": { "field": "lon_num", "type": "quantitative" },
        "latitude": { "field": "lat_num", "type": "quantitative" },
        "size": {
          "field": "mission_count",
          "type": "quantitative",
          "title": "Number of Missiles",
          "scale": { "type": "sqrt", "domain": [1, 4325], "range": [50, 3000] },
          "legend": {
            "values": [10, 100, 500, 1200],
            "titleFontSize": 12,
            "labelFontSize": 11
          }
        },
        "tooltip": [
          { "field": "Country", "type": "nominal", "title": "Country" },
          { "field": "mission_count", "type": "quantitative", "title": "Total Missiles", "format": "," }
        ]
      }
    }
  ]
}

