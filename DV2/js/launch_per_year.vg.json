{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "width": 1100,
  "height": 200,
  "background": "transparent",
  "title": {
    "text": "Total Launches per Year",
    "fontSize": 20,
    "anchor": "middle",
    "color": "white"
  },
  "data": { "url": "https://raw.githubusercontent.com/hzam0001/FIT3179-DV2/refs/heads/main/DV2/data/All_space_missions(2).csv" },

  "transform": [
    { "calculate": "toNumber(datum.Year)", "as": "YearNum" },
    { "filter": "datum.YearNum >= 1957 && datum.YearNum <= 2021" },
    {
      "aggregate": [
        { "op": "count", "as": "Launches" }
      ],
      "groupby": ["YearNum"]
    },
    { "sort": [{ "field": "YearNum", "order": "ascending" }] }
  ],

  "layer": [
    {
      "mark": { "type": "line", "interpolate": "monotone", "color": "#4da6ff" },
      "encoding": {
        "x": {
          "field": "YearNum",
          "type": "quantitative",
          "title": "Year",
          "axis": { 
            "grid": false, 
            "tickCount": 14, 
            "labelAngle": 0, 
            "format": "d",
            "labelColor": "white",
            "titleColor": "white",
            "domainColor": "white",
            "tickColor": "white"
          },
          "scale": { "domain": [1952, 2021] }
        },
        "y": {
          "field": "Launches",
          "type": "quantitative",
          "title": "Total Launches",
          "axis": { 
            "grid": false,
            "labelColor": "white",
            "titleColor": "white",
            "domainColor": "white",
            "tickColor": "white"
          }
        }
      }
    },

    {
      "mark": { "type": "point", "filled": true, "size": 60, "color": "#4da6ff" },
      "encoding": {
        "x": { "field": "YearNum", "type": "quantitative" },
        "y": { "field": "Launches", "type": "quantitative" },
        "tooltip": [
          { "field": "YearNum", "type": "quantitative", "title": "Year", "format": "d" },
          { "field": "Launches", "type": "quantitative", "title": "Launches", "format": "," }
        ]
      }
    },

    {
      "description": "Milestone leader lines and annotations (two lines, centered)",
      "transform": [
        {
          "filter": "indexof([1957,1961,1969,1976,1981,1990,2001,2015,2019,2021], datum.YearNum) >= 0"
        },
        {
          "calculate": "datum.YearNum == 1957 ? datum.Launches + 18 : datum.YearNum == 1961 ? datum.Launches + 14 : datum.YearNum == 1969 ? datum.Launches + 20 : datum.YearNum == 1976 ? datum.Launches + 12 : datum.YearNum == 1981 ? datum.Launches + 16 : datum.YearNum == 1990 ? datum.Launches + 18 : datum.YearNum == 2001 ? datum.Launches + 14 : datum.YearNum == 2015 ? datum.Launches + 20 : datum.YearNum == 2019 ? datum.Launches + 22 : datum.YearNum == 2021 ? datum.Launches + 26 : datum.Launches + 12",
          "as": "labelY"
        },
        {
          "calculate": "datum.YearNum == 1957 ? '1957: Sputnik 1 first' : datum.YearNum == 1961 ? '1961: First human Yuri' : datum.YearNum == 1969 ? '1969: Apollo 11 lands' : datum.YearNum == 1976 ? '1976: Viking 1 Mars' : datum.YearNum == 1981 ? '1981: NASA launches' : datum.YearNum == 1990 ? '1990: Hubble space telescope' : datum.YearNum == 2001 ? '2001: First space tourist' : datum.YearNum == 2015 ? '2015: First spacecraft' : datum.YearNum == 2019 ? '2019: Farthest object' : datum.YearNum == 2021 ? '2021: James Webb Space' : ''",
          "as": "labelLine1"
        },
        {
          "calculate": "datum.YearNum == 1957 ? 'artificial satellite' : datum.YearNum == 1961 ? 'Gagarin flight' : datum.YearNum == 1969 ? 'on the Moon' : datum.YearNum == 1976 ? 'lander success' : datum.YearNum == 1981 ? 'Space Shuttle Columbia' : datum.YearNum == 1990 ? 'launch success' : datum.YearNum == 2001 ? 'orbital flight' : datum.YearNum == 2015 ? 'flyby of Pluto' : datum.YearNum == 2019 ? '2014 MU69 explored' : datum.YearNum == 2021 ? 'Telescope launch' : ''",
          "as": "labelLine2"
        }
      ],
      "layer": [
        {
          "mark": { "type": "rule", "strokeWidth": 1.2, "color": "#999", "strokeDash": [4,2] },
          "encoding": {
            "x": { "field": "YearNum", "type": "quantitative" },
            "y": { "field": "Launches", "type": "quantitative" },
            "y2": { "field": "labelY", "type": "quantitative" }
          }
        },
        {
          "mark": {
            "type": "text",
            "align": "center",
            "baseline": "bottom",
            "fontSize": 11,
            "fontWeight": "600",
            "dx": 0,
            "dy": -8,
            "color": "white"
          },
          "encoding": {
            "x": { "field": "YearNum", "type": "quantitative" },
            "y": { "field": "labelY", "type": "quantitative" },
            "text": { "field": "labelLine2", "type": "nominal" }
          }
        },
        {
          "mark": {
            "type": "text",
            "align": "center",
            "baseline": "bottom",
            "fontSize": 11,
            "fontWeight": "600",
            "dx": 0,
            "dy": -26,
            "color": "white"
          },
          "encoding": {
            "x": { "field": "YearNum", "type": "quantitative" },
            "y": { "field": "labelY", "type": "quantitative" },
            "text": { "field": "labelLine1", "type": "nominal" }
          }
        }
      ]
    },

    {
      "description": "1991 vertical rule + centered two-line label",
      "transform": [
        { "filter": "datum.YearNum == 1991" }
      ],
      "layer": [
        {
          "mark": { "type": "rule", "strokeWidth": 2, "color": "#ff6b6b", "strokeDash": [6,4] },
          "encoding": {
            "x": { "field": "YearNum", "type": "quantitative", "scale": { "domain": [1957, 2021] } }
          }
        },
        {
          "mark": {
            "type": "text",
            "align": "center",
            "baseline": "bottom",
            "fontSize": 12,
            "fontWeight": "bold",
            "dx": 0,
            "dy": 50,
            "color": "white"
          },
          "encoding": {
            "x": { "field": "YearNum", "type": "quantitative" },
            "y": { "field": "Launches", "type": "quantitative" },
            "text": { "value": "1991: End of" }
          }
        },
        {
          "mark": {
            "type": "text",
            "align": "center",
            "baseline": "bottom",
            "fontSize": 12,
            "fontWeight": "bold",
            "dx": 0,
            "dy": 65,
            "color": "white"
          },
          "encoding": {
            "x": { "field": "YearNum", "type": "quantitative" },
            "y": { "field": "Launches", "type": "quantitative" },
            "text": { "value": "Cold War Era" }
          }
        }
      ]
    }
  ],
  
  "config": {
    "view": { "stroke": "transparent" },
    "background": "transparent"
  }
}